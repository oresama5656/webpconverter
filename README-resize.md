# WebP画像変換ツール（縮小率指定版）

指定した縮小率で画像をリサイズしながらWebP変換するNode.jsツールです。

## 🎯 目的

元画像を指定した縮小率でリサイズし、高品質なWebP画像に変換します。

## 🔁 処理フロー

1. `input_images/` にある `.png`, `.jpg`, `.jpeg`, `.webp` を対象にする
2. コマンドライン引数で縮小率を指定（例: 0.5 = 50%サイズ）
3. 各画像を指定した縮小率でリサイズ
4. 高品質WebP変換（quality: 90, effort: 6）
5. 出力ファイルは `output_webp_resize/` に保存

## 📁 フォルダ構成

```
webptool/
├── input_images/           ← 元画像をここに入れる
├── temp_images/            ← 一時処理用（自動管理）
├── output_webp_resize/     ← 出力されるWebP画像（縮小版）
├── convert-resize.js       ← 縮小率指定版スクリプト
└── README-resize.md        ← このファイル
```

## ⚙️ 使用ライブラリ

- `sharp` - 画像リサイズ・WebP変換用
- Node.js標準モジュール（fs, path）

## 🚀 使用方法

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 画像の配置

変換したい画像を `input_images/` フォルダに配置します。

対応形式: `.png`, `.jpg`, `.jpeg`, `.webp`

### 3. 変換実行

#### 方法1: コマンドライン
縮小率を指定して実行します：

```bash
# 50%サイズに縮小
node convert-resize.js 0.5

# 25%サイズに縮小
node convert-resize.js 0.25

# 75%サイズに縮小
node convert-resize.js 0.75
```

または npm script を使用：

```bash
npm run resize 0.5
```

#### 方法2: ダブルクリック（推奨）
- `start-resize.bat` をダブルクリック（縮小率を入力）
- または `start-webp-converter.bat` をダブルクリックして選択

### 4. 結果確認

変換された画像は `output_webp_resize/` フォルダに保存されます。

## 📊 処理例

```
🚀 WebP画像変換ツール（縮小率指定版）開始

🎯 指定縮小率: 0.5 (50%)
📊 処理対象: 3 ファイル
対象ファイル: sample1.png, sample2.jpg, sample3.webp

🔄 処理開始: sample1.png
📏 元サイズ: 640 x 480
🔍 縮小率: 0.5x
📏 リサイズ: 640x480 → 320x240
🔄 WebP変換完了: sample1.webp
✅ 変換完了: sample1.webp

🔄 処理開始: sample2.jpg
📏 元サイズ: 1920 x 1080
🔍 縮小率: 0.5x
📏 リサイズ: 1920x1080 → 960x540
🔄 WebP変換完了: sample2.webp
✅ 変換完了: sample2.webp

🎉 すべての処理が完了しました！
📁 出力先: output_webp_resize/
```

## 📌 特徴

- ✅ 任意の縮小率を指定可能（0 < 縮小率 <= 1）
- ✅ 高品質WebP変換（quality: 90）
- ✅ 詳細な処理ログ表示
- ✅ 自動フォルダ管理
- ✅ エラーハンドリング

## 🔧 縮小率の例

| 縮小率 | サイズ | 例 |
|--------|--------|-----|
| 1.0 | 100% | 元サイズ |
| 0.75 | 75% | 1920x1080 → 1440x810 |
| 0.5 | 50% | 1920x1080 → 960x540 |
| 0.25 | 25% | 1920x1080 → 480x270 |
| 0.1 | 10% | 1920x1080 → 192x108 |

## ⚠️ 注意事項

- 縮小率は 0 より大きく 1 以下の値を指定してください
- 処理中は `temp_images/` フォルダが一時的に使用されます
- 大きな画像や多数の画像を処理する場合は時間がかかる場合があります

## 🐛 トラブルシューティング

### エラー: 有効な縮小率を指定してください
- 縮小率は 0 < 縮小率 <= 1 の範囲で指定してください
- 例: `node convert-resize.js 0.5`

### エラー: input_images フォルダが見つかりません
- `input_images/` フォルダを作成し、変換したい画像を配置してください

### エラー: 処理対象の画像ファイルが見つかりません
- 対応形式（.png, .jpg, .jpeg, .webp）のファイルを `input_images/` に配置してください

### WebP変換エラー
- sharpが正しくインストールされているか確認してください
- `npm install` を再実行してください

## 🔄 元のツールとの違い

| 機能 | 元のツール (convert.js) | 縮小率指定版 (convert-resize.js) |
|------|------------------------|--------------------------------|
| 出力サイズ | 元画像と同じサイズ | 指定した縮小率でリサイズ |
| 拡大処理 | 自動拡大（画質向上） | なし |
| 出力フォルダ | `output_webp/` | `output_webp_resize/` |
| 使用方法 | `node convert.js` | `node convert-resize.js 0.5` | 